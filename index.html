<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport"
        content="width=device-width, initial-scale=1.0, user-scalable=no" />
  <title>Money Money Come Come üí∏ ‚Äî Bigwin Sayar! (Premium)</title>
  <meta name="description" content="Premium Big/Small prediction with pro UI" />
  <meta name="keywords" content="ck, lottery, wingo, big small, premium, prediction" />

  <!-- Firebase -->
  <script src="https://www.gstatic.com/firebasejs/9.6.11/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.11/firebase-database-compat.js"></script>

  <!-- Icons -->
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" rel="stylesheet"/>

  <style>
    :root{
      --bg-main:#07070c;
      --glass:#0f0f17cc;
      --border:#2b2b3b;
      --text:#e9e9f4;
      --sub:#a6a6bf;
      --muted:#7a7a93;
      --gold:#ffd54d;
      --neon:#00ffb2;
      --pill-big:#ffa500;
      --pill-small:#00aaff;
      --card-grad: linear-gradient(145deg, #151524 0%, #0b0b14 100%);
      --glow: 0 0 28px rgba(255, 213, 77, .3);
      --soft: 0 10px 35px rgba(0,0,0,.5);
      --blur: blur(14px);
      --tr: .35s cubic-bezier(.4,0,.2,1);
    }
    *{box-sizing:border-box;margin:0;padding:0}
    body{
      font-family: ui-sans-serif, Segoe UI, Inter, Roboto, system-ui;
      background: radial-gradient(1000px 600px at 30% -10%, #191933 0%, #07070c 55%);
      color: var(--text);
      min-height:100vh;
    }
    .wrap{ max-width:1100px; margin:28px auto; padding: 16px; }

    /* HEADER */
    .pro-header{
      position: relative;
      border-radius: 22px;
      padding: 28px 22px;
      background: var(--glass);
      backdrop-filter: var(--blur);
      border: 1px solid var(--border);
      box-shadow: var(--soft);
      margin-bottom: 16px;
    }
    .title{
      font-weight:900; line-height:1.1;
      font-size: clamp(28px, 4vw, 42px);
      background: linear-gradient(90deg, #ffe38a 0%, #ff9a3c 45%, #fff2c6 80%);
      -webkit-background-clip:text; -webkit-text-fill-color:transparent;
      text-shadow: 0 0 22px rgba(255, 213, 77, .35);
    }
    .subtitle{ font-size:1.3rem; font-weight:800; color:var(--gold); }
    .desc{ color:var(--sub); margin-top:6px; }

    .next-box{ margin-top:16px; display:flex; gap:12px; align-items:center; }
    .next-label{ font-weight:800; color:var(--neon); }
    .pill{
      padding:10px 18px; border-radius:999px; font-weight:800;
      border:2px solid transparent; text-transform:uppercase;
    }
    .pill.big{ color:var(--pill-big); background:rgba(255,165,0,.16); }
    .pill.small{ color:var(--pill-small); background:rgba(0,170,255,.16); }
    .conf{ padding:6px 10px; border-radius:8px; border:1px solid rgba(0,255,178,.35); background:rgba(0,255,178,.08); }

    /* CARD */
    .card{ background: var(--card-grad); border:1px solid var(--border); border-radius:18px; box-shadow: var(--soft); }
    .card-head{ display:flex; justify-content:space-between; padding:14px 16px; border-bottom:1px solid var(--border); }
    .tools{ display:flex; gap:10px; }
    .btn{ padding:8px 12px; border-radius:10px; border:1px solid rgba(255,255,255,.12); background:rgba(255,255,255,.05); color:var(--text); font-weight:700; cursor:pointer; }

    /* TABLE */
    table{ width:100%; border-collapse:collapse; }
    thead th{ padding:10px; text-align:left; font-size:.85rem; border-bottom:1px solid var(--border); }
    tbody td{ padding:10px; border-bottom:1px solid rgba(255,255,255,.06); }
    .issue{ font-family:monospace; color:#bcbcd6; }
    .win{ color:#00ffaa; font-weight:800; }
    .lose{ color:#ff6b6b; font-weight:800; }
  </style>
</head>
<body>
<div class="wrap">
  <section class="pro-header">
    <h1 class="title">üí∏ Money Money Come Come üí∏</h1>
    <h2 class="subtitle">Bigwin Sayar!</h2>
    <p class="desc">Thank for using.</p>
    <div class="next-box">
      <span class="next-label">Next :</span>
      <span id="next-pill" class="pill">‚Äî</span>
      <span id="next-issue" class="conf">Issue ‚Äî</span>
    </div>
  </section>

  <section class="card">
    <div class="card-head">
      <span>Premium Prediction</span>
      <div class="tools">
        <button id="btnCsv" class="btn">CSV</button>
        <button id="btnJson" class="btn">JSON</button>
      </div>
    </div>
    <div class="table-wrap">
      <table>
        <thead>
        <tr>
          <th>Issue</th>
          <th>·Äî·Ä∂·Äï·Ä´·Äê·Ä∫</th>
          <th>·ÄÄ·Äª·Äû·ÄΩ·Ä¨·Ä∏</th>
          <th>·ÄÅ·Äî·Ä∑·Ä∫·Äô·Äæ·Äî·Ä∫·Ä∏</th>
          <th>·Äõ·Äú·Äí·Ä∫</th>
          <th>Premium</th>
          <th>·Äû·Ä±·ÄÅ·Äª·Ä¨·Äô·Ä∞</th>
        </tr>
        </thead>
        <tbody id="tbody">
        <tr><td colspan="7" style="text-align:center;">Loading...</td></tr>
        </tbody>
      </table>
    </div>
  </section>
</div>

<script>
const bigwinConfig = {
  apiKey: "AIzaSyArgde3-Xn0boi6FO-ZfN6vPPMRdULPN24",
  authDomain: "bigwin30-3d1e2.firebaseapp.com",
  databaseURL: "https://bigwin30-3d1e2-default-rtdb.europe-west1.firebasedatabase.app/",
  projectId: "bigwin30-3d1e2",
  storageBucket: "bigwin30-3d1e2.appspot.com",
  messagingSenderId: "214823361254",
  appId: "1:214823361254:web:9b9f101f2134e2bc48f927"
};
const app = firebase.initializeApp(bigwinConfig, "bigwin-premium-only");
const db  = firebase.database(app);

const toBigIntSafe = (x) => { try { return BigInt(String(x).replace(/\D/g,'')||"0"); } catch { return 0n; } };
const lastDigit = (n) => parseInt(String(n).trim().slice(-1))||0;
const classify = (num) => (lastDigit(num) >= 5 ? "BIG" : "SMALL");
const pillClass = (v) => v === "BIG" ? "pill big" : "pill small";

function enhancedPrediction(history){
  const recent = history.slice(0, 20);
  let prediction = "", confidence = "Low";
  const premiumResults = recent.filter(r => r.premium && r.premium !== "");
  const premiumWinCount = premiumResults.filter(r => r.result === "Win").length;
  const premiumWinRate = premiumResults.length ? (premiumWinCount / premiumResults.length) : 0;
  if (premiumWinRate > 0.65 && premiumResults.length >= 5){
    const lastPremiumWin = premiumResults.find(r => r.result === "Win");
    if (lastPremiumWin){ prediction = lastPremiumWin.predicted; confidence = "Height"; }
  }
  if (!prediction && recent.length >= 5){
    const streakType = recent[0].actual;
    const streakLen = recent.findIndex(r => r.actual !== streakType);
    if (streakLen >= 4){ prediction = streakType === "BIG" ? "SMALL" : "BIG"; confidence = "Medium"; }
  }
  if (!prediction && recent.length >= 10){
    const bigCount = recent.filter(v=>v.actual==="BIG").length;
    const smallCount = recent.length - bigCount;
    if (bigCount - smallCount >= 4){ prediction = "SMALL"; confidence="Medium"; }
    else if (smallCount - bigCount >= 4){ prediction = "BIG"; confidence="Medium"; }
  }
  if (!prediction){
    const lastWin = recent.find(r => r.result === "Win");
    if (lastWin){ prediction = lastWin.predicted; confidence = "Medium"; }
  }
  if (!prediction){
    const bigBias = recent.filter(r=>r.actual==="BIG").length;
    prediction = bigBias > recent.length/2 ? "BIG" : "SMALL";
    confidence = "Low";
  }
  return { prediction, confidence };
}

const tbodyEl = document.getElementById("tbody");
const nextPill = document.getElementById("next-pill");
const nextIssue = document.getElementById("next-issue");

let computedRows = [];

db.ref("bigwin/default").on("value", (snap)=>{
  const v = snap.val();
  if (!v) return;
  const raw = Array.isArray(v.list) ? v.list.filter(Boolean)
             : (v.list && typeof v.list === 'object' ? Object.values(v.list) : []);
  let list = raw.map(it => ({
    issueStr: String(it.issueNumber ?? it.issue ?? "").trim(),
    issueBI : toBigIntSafe(it.issueNumber ?? it.issue ?? ""),
    number  : it.number ?? it.result ?? "",
    premium : it.premium ?? ""
  })).filter(it => it.issueStr.length>0);
  list.sort((a,b)=> (b.issueBI > a.issueBI ? 1 : -1));

  const base = list.map(row => ({
    issue: row.issueStr,
    number: String(row.number),
    actual: classify(row.number),
    predicted: "",
    result: "",
    premium: String(row.premium ?? ""),
    confidence: ""
  })).reverse();

  computedRows = base.map((row, idx, arr)=>{
    const history = arr.slice(0, idx).reverse();
    const pred = enhancedPrediction(history);
    const isWin = (pred.prediction === row.actual);
    return { ...row, predicted: pred.prediction, result: isWin ? "Win" : "Lose", confidence: pred.confidence };
  });

  const rowsForUi = [...computedRows].reverse();
  tbodyEl.innerHTML = "";
  rowsForUi.forEach(row=>{
    const confColor = row.confidence==="Height" ? "#00ffb2" : row.confidence==="Medium" ? "#ffd54d" : "#9aa1b2";
    tbodyEl.innerHTML += `
      <tr>
        <td class="issue">${row.issue}</td>
        <td>${row.number}</td>
        <td><span class="${pillClass(row.actual)}">${row.actual}</span></td>
        <td><span class="${pillClass(row.predicted)}">${row.predicted}</span></td>
        <td class="${row.result==='Win'?'win':'lose'}">${row.result}</td>
        <td>${row.premium || "-"}</td>
        <td style="color:${confColor}; font-weight:800;">${row.confidence}</td>
      </tr>
    `;
  });

  const latestIssue = list.reduce((mx, it)=> it.issueBI>mx?it.issueBI:mx, -1n);
  const nextIssueStr = (latestIssue+1n).toString();
  const next = enhancedPrediction([...computedRows].reverse());
  nextPill.textContent = `${next.prediction} (${next.confidence})`;
  nextPill.className = pillClass(next.prediction);
  nextIssue.textContent = `Issue ${nextIssueStr}`;
});
</script>
</body>
</html>
